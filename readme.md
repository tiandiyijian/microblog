## 笔记

#### 第十三章：国际化和本地化

使用Flask-Babel可以提取需要翻译的文本，并且提供了翻译的函数。

#### 第十四章：Ajax

`langdetect`库可以检测文本的语种，在用户发帖时检测其语种并保存到数据库中。在展示帖子时判断其语种和用户浏览器语种是否一致，如果不一致的话浏览器向服务器发出翻译的请求，服务器把翻译后的文本发给浏览器，浏览器再更新DOM。

#### 第十五章：优化应用结构
之前的代码中所有的功能都写在了一起，但是观察后发现可以把它们分成用户认证子系统、错误处理子系统和核心应用功能三个子系统，通过flask的blueprints功能可以把不同的子系统分开来存放。

另外，之前的flask应用实例被创建为全局变量，虽然这本身并不是问题，但将应用实例作为全局变量可能会使某些情况复杂化，特别是与测试相关的情景。更好的解决方案是不将应用设置为全局变量，而是使用应用工厂函数在运行时创建它。

`.env`和`.flaskenv`文件可以存储环境变量，安装`python-dotenv`包之后flask命令会自动导入其中的变量。一般来说`.flaskenv`文件用于`Flask`自己的配置变量，`.env`文件用于应用的配置变量（包括敏感内容），前者可以被添加进版本控制中，后者则不建议。